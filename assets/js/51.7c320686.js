(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{312:function(e,t,a){"use strict";a.r(t);var n=a(6),r=Object(n.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"生产环境项目部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生产环境项目部署","aria-hidden":"true"}},[e._v("#")]),e._v(" 生产环境项目部署")]),e._v(" "),a("ul",[a("li",[e._v("下载node,并执行命令安装node配置PATH路径:")])]),e._v(" "),a("div",{staticClass:"language-$shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ wget https://nodejs.org/dist/v10.16.3/node-v10.16.3-linux-x64.tar.xz\n$ tar xvf node-v10.16.3-linux-x64.tar.xz\n$ mv node-v10.16.3-linux-x64 /opt/\n$ sudo vi /etc/profile\n增加对应的node的PATH路径,例如如下:\nexport path ="/opt/node-v10.16.3-linux-x64/bin:$PATH"\n\n执行如下命令使上面的PATH配置生效\n$ source /etc/profile \n\n执行如下命令确认node环境变量配置成功\n$ node -v\n$ npm -v \n')])])]),a("ul",[a("li",[e._v("安装"),a("code",[e._v("pm2")]),e._v("命令用于后台服务静默执行:")])]),e._v(" "),a("div",{staticClass:"language-$shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ npm i pm2 -g\n\n配置pm2开机启动脚本\n$ pm2 startup \n")])])]),a("ul",[a("li",[e._v("安装node的包管理器"),a("code",[e._v("yarn")]),e._v("(当然此处也可以不安装,直接使用node内置的"),a("code",[e._v("npm")]),e._v("来管理包):")])]),e._v(" "),a("div",{staticClass:"language-$shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ npm i yarn -g\n")])])]),a("ul",[a("li",[e._v("复制当前所有包文件,解压,然后在当前文件夹下执行命令安装编译工程:")])]),e._v(" "),a("div",{staticClass:"language-$shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("$ yarn \n$ yarn build\n\n编译程序, 然后配置pm2程序\n$ pm2 start  ecosystem.config.js --watch\n$ pm2 save\n")])])]),a("ul",[a("li",[e._v("执行pm2命令确认程序启动是否没有问题:")])]),e._v(" "),a("div",{staticClass:"language-shell script extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("$ pm2 list\n$ pm2 monit\n$ pm2 logs\n")])])]),a("p",[e._v("如果上述配置都没有问题,name应用程序会在"),a("code",[e._v("http://127.0.0.0:3000")]),e._v("启动应用程序,然后我们只需要在nginx配置\n请求反转到改http实例即可,参考配置如下:")]),e._v(" "),a("div",{staticClass:"language-editorconfig extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(' # proxy for  project\n location  / {\n          alias   /www/the project folder/;\n          proxy_pass http://127.0.0.1:3000/;\n          \n          proxy_http_version      1.1;\n          proxy_cache_bypass      $http_upgrade;\n          \n          proxy_set_header Upgrade                        $http_upgrade;\n          proxy_set_header Connection             "upgrade";\n          proxy_set_header Host                           $host;\n          proxy_set_header X-Real-IP                      $remote_addr;\n          proxy_set_header X-Forwarded-For        $proxy_add_x_forwarded_for;\n          proxy_set_header X-Forwarded-Proto      $scheme;\n          proxy_set_header X-Forwarded-Host       $host;\n          proxy_set_header X-Forwarded-Port       $server_port;\n\n }\n')])])])])},[],!1,null,null,null);t.default=r.exports}}]);