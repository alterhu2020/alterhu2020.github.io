<!DOCTYPE html>
<html lang="en">
<head>

        <title>[Linux环境搭建] svn 安装配置</title>
        <meta charset="utf-8"/>
        <meta name="description" content="



SVN 安装 执行如下命令进行安装: $ sudo apt-get -y install subversion 启动 svn 服务: d代表的是daemon 进程 $ svnserve -d $ ps aux | grep svnserve 若出现如下内容： wkr 6537 0.0 0.0 13784 956 ? Ss 16:18 0:00 svnserve -d wkr 7593 0.0 0.0 5784 864 pts/0 S+ 21:57 0:00 grep –color=auto svnserve 表示服务已开启。（注意：一定要有第1行，只有第2行说明服务未启动） 关闭svn服务: $ killall svnserve 重启 svn服务: $ svnserve -d -r /srv 新建一个仓库: $ sudo adduser --system --home /srv/svn --disabled-password --disabled-login --group svn $ sudo svnadmin create /srv/svn $ sudo chown -R svn:svn /srv/svn change user, change group 改变文件对应的用户和用户组 修改仓库配置文件 编辑配置文件: svnserve.conf $ sudo nano /srv/svn/conf/svnserve.conf [general] anon-access = none auth-access = write authz-db = authz 修改帐户文件nano /srv/svn/conf/passwd 和 sudo nano /srv/svn/conf/authz, 此处忽略. 配置svn开机自动启动 新建一个svnserve配置文件在/et/default/svnserve文件,内容如下: # svnserve options DAEMON_ARGS="--daemon --pid-file /run/svnserve/svnserve.pid --root /srv/svn --log-file …">
        <meta name="keywords"
              content="Linux,pelican,github,软件测试,测试框架,测试开发,白盒测试,Selenium,Selenium开发,Vuejs,树莓派,自动化测试,编程语言,大数据,人工智能,开源软件,创业,程序员找工作,移动互联网,生活时尚,情感交流,软件测试,技术博客">


            <link href="https://pingbook.top/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
                  title="PingBook博客 Full Atom Feed"/>


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="../../theme/gumby.css"/>
        <link rel="stylesheet" type="text/css" href="../../theme/style.css"/>
        <link rel="stylesheet" type="text/css" href="../../theme/pygment.css"/>

        <script src="../../theme/js/libs/modernizr-2.6.2.min.js"></script>



        <!---->

</head>

<body id="index" class="home">


<div class="container">

    <div class="row">

        <header id="banner" class="body">
            <h1><a href="../..">PingBook博客 <strong></strong></a></h1>
        </header><!-- /#banner -->

        <div id="navigation" class="navbar row">
            <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>

            <ul class="columns">
                <li><a href="../../">主页</a></li>

                    <li><a href="/categories">分类</a></li>
                    <li><a href="/archives">归档</a></li>
                    <li><a href="/tags">标签</a></li>

            </ul>
        </div>

    <section id="content" class="body">

        <div class="row">
            <div class="eleven columns">


                <header>
                    <h2 class="entry-title">
                        <a href="../../articles/pi-svn/" rel="bookmark"
                           title="Permalink to [Linux环境搭建] svn 安装配置">[Linux环境搭建]  svn&nbsp;安装配置</a></h2>
                    
                </header>
                <footer class="post-info">
                    <!--<abbr class="published" title="2018-07-09T21:33:36.432567+08:00">-->
                    <!--2018 七月 09 日, 星期一-->
                    <!--</abbr>-->
                    <!---->
                        <!--<address class="vcard author">By -->
                        <!---->
                            <!--<a class="url fn" href="../../author/walter-hu"> Walter Hu</a>-->
                            <!---->
                        <!--</address>-->
                        <!---->
                    <address class="vcard author" style="font-style:italic;margin-bottom:-10px;">
                        2018 七月 09 日, 星期一
                            &nbsp;&nbsp;<作者></作者>
                            <a class="url fn" href="../../author/walter-hu">Walter Hu</a>

                        <span id="busuanzi_container_page_pv">, 浏览量:<span id="busuanzi_value_page_pv"></span></span>
                        &nbsp;&nbsp;<p style="color:red;">本文出自<a href="https://pingbook.top">PingBook博客</a>,转载请务必保留出处<a href="../../articles/pi-svn/">../../articles/pi-svn/</a></p>
                    </address>
                    <hr/>
                </footer><!-- /.post-info -->
                <div class="entry-content">
                    <h2><span class="caps">SVN</span>&nbsp;安装</h2>
<ol>
<li>执行如下命令进行安装:</li>
</ol>
<div class="highlight"><pre><span class="code-line"><span></span>$ sudo apt-get -y install subversion</span>
</pre></div>


<ol>
<li>启动 <code>svn</code> 服务: </li>
</ol>
<div class="highlight"><pre><span class="code-line"><span></span>d代表的是daemon 进程</span>
<span class="code-line">$ svnserve -d</span>
<span class="code-line">$ ps aux | grep svnserve</span>
<span class="code-line">若出现如下内容：</span>
<span class="code-line"></span>
<span class="code-line">wkr 6537 0.0 0.0 13784 956 ? Ss 16:18 0:00 svnserve -d</span>
<span class="code-line">wkr 7593 0.0 0.0 5784 864 pts/0 S+ 21:57 0:00 grep –color=auto svnserve</span>
<span class="code-line"></span>
<span class="code-line">表示服务已开启。（注意：一定要有第1行，只有第2行说明服务未启动）</span>
</pre></div>


<ol>
<li>关闭<code>svn</code>服务:</li>
</ol>
<div class="highlight"><pre><span class="code-line"><span></span>$  killall svnserve</span>
</pre></div>


<ol>
<li>重启 <code>svn</code>服务:</li>
</ol>
<div class="highlight"><pre><span class="code-line"><span></span>$ svnserve -d -r /srv</span>
</pre></div>


<ol>
<li>新建一个仓库:</li>
</ol>
<div class="highlight"><pre><span class="code-line"><span></span>$ sudo adduser --system --home /srv/svn --disabled-password --disabled-login --group svn</span>
<span class="code-line">$ sudo svnadmin create /srv/svn</span>
<span class="code-line">$ sudo chown -R svn:svn /srv/svn</span>
<span class="code-line">change user, change group 改变文件对应的用户和用户组</span>
</pre></div>


<ol>
<li>修改仓库配置文件<br>
编辑配置文件:&nbsp;svnserve.conf</li>
</ol>
<div class="highlight"><pre><span class="code-line"><span></span>$ sudo nano /srv/svn/conf/svnserve.conf</span>
<span class="code-line"><span class="o">[</span>general<span class="o">]</span></span>
<span class="code-line">anon-access <span class="o">=</span> none</span>
<span class="code-line">auth-access <span class="o">=</span> write</span>
<span class="code-line">authz-db <span class="o">=</span> authz</span>
</pre></div>


<p>修改帐户文件<code>nano /srv/svn/conf/passwd</code> 和 <code>sudo nano /srv/svn/conf/authz</code>,&nbsp;此处忽略.</p>
<ol>
<li>配置svn开机自动启动</li>
<li>新建一个svnserve配置文件在<code>/et/default/svnserve</code>文件,内容如下:</li>
</ol>
<div class="highlight"><pre><span class="code-line"><span></span># svnserve options</span>
<span class="code-line">DAEMON_ARGS=&quot;--daemon --pid-file /run/svnserve/svnserve.pid --root /srv/svn --log-file /var/log/svn/svnserve.log&quot;</span>
</pre></div>


<ol>
<li><strong>注意</strong> 新建log文件,这些是<code>/etc/default/svnserve</code>中的文件的配置涉及的几个文件,如果执行<code>sudo systemctl restart svnserve.service</code>失败,会自动删除文件夹<code>/run/svnserve</code></li>
</ol>
<div class="highlight"><pre><span class="code-line"><span></span>$ sudo mkdir /run/svnserve</span>
<span class="code-line">$ sudo chown -R svn:svn /run/svnserve/</span>
<span class="code-line">$ sudo chmod -R <span class="m">777</span> /run/svnserve/</span>
<span class="code-line">$ sudo mkdir /var/log/svn</span>
<span class="code-line">$ sudo chown -R svn:svn /var/log/svn/</span>
<span class="code-line">$ sudo chmod -R <span class="m">777</span> /var/log/svn/</span>
</pre></div>


<ol>
<li>新建service启动服务文件</li>
</ol>
<div class="highlight"><pre><span class="code-line"><span></span>$ sudo nano /etc/systemd/system/svnserve.service</span>
<span class="code-line"><span class="o">[</span>Unit<span class="o">]</span></span>
<span class="code-line"><span class="nv">Description</span><span class="o">=</span>Subversion protocol daemon</span>
<span class="code-line"><span class="nv">After</span><span class="o">=</span>syslog.target network.target</span>
<span class="code-line"></span>
<span class="code-line"><span class="o">[</span>Service<span class="o">]</span></span>
<span class="code-line"><span class="nv">Type</span><span class="o">=</span>forking</span>
<span class="code-line"><span class="nv">RuntimeDirectory</span><span class="o">=</span>svnserve</span>
<span class="code-line"><span class="nv">PIDFile</span><span class="o">=</span>/run/svnserve/svnserve.pid</span>
<span class="code-line"><span class="nv">EnvironmentFile</span><span class="o">=</span>/etc/default/svnserve</span>
<span class="code-line"><span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/svnserve <span class="nv">$DAEMON_ARGS</span></span>
<span class="code-line"><span class="nv">User</span><span class="o">=</span>svn</span>
<span class="code-line"><span class="nv">Group</span><span class="o">=</span>svn</span>
<span class="code-line"><span class="nv">KillMode</span><span class="o">=</span>control-group</span>
<span class="code-line"><span class="nv">Restart</span><span class="o">=</span>on-failure</span>
<span class="code-line"></span>
<span class="code-line"><span class="o">[</span>Install<span class="o">]</span></span>
<span class="code-line"><span class="nv">WantedBy</span><span class="o">=</span>multi-user.target</span>
</pre></div>


<p>重启机器后出现这个错误:(原因是上面的第一个操作我没有做,就是没有创建一个文件<code>/etc/default/svnserve</code>,或者其中涉及到的文件<code>/var/log/svn</code>,<code>/run/svnserve</code>没有新建,或者没有配置可写权限对于用户<code>svn</code>)</p>
<div class="highlight"><pre><span class="code-line"><span></span><span class="nt">pi</span><span class="p">@</span><span class="k">pingbook</span><span class="o">:~$</span> <span class="nt">systemctl</span> <span class="nt">status</span> <span class="nt">svnserve</span><span class="p">.</span><span class="nc">service</span> </span>
<span class="code-line"><span class="err">●</span> <span class="nt">svnserve</span><span class="p">.</span><span class="nc">service</span> <span class="nt">-</span> <span class="nt">Subversion</span> <span class="nt">protocol</span> <span class="nt">daemon</span></span>
<span class="code-line">   <span class="nt">Loaded</span><span class="o">:</span> <span class="nt">loaded</span> <span class="o">(/</span><span class="nt">etc</span><span class="o">/</span><span class="nt">systemd</span><span class="o">/</span><span class="nt">system</span><span class="o">/</span><span class="nt">svnserve</span><span class="p">.</span><span class="nc">service</span><span class="p">;</span> <span class="nt">enabled</span><span class="o">;</span> <span class="nt">vendor</span> <span class="nt">preset</span><span class="o">:</span> <span class="nt">enabled</span><span class="o">)</span></span>
<span class="code-line">   <span class="nt">Active</span><span class="o">:</span> <span class="nt">failed</span> <span class="o">(</span><span class="nt">Result</span><span class="o">:</span> <span class="nt">resources</span><span class="o">)</span> <span class="nt">since</span> <span class="nt">Sun</span> <span class="nt">2018-07-08</span> <span class="nt">20</span><span class="p">:</span><span class="nd">06</span><span class="p">:</span><span class="nd">56</span> <span class="nt">CST</span><span class="o">;</span> <span class="nt">28s</span> <span class="nt">ago</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="nt">7月</span> <span class="nt">08</span> <span class="nt">20</span><span class="p">:</span><span class="nd">06</span><span class="p">:</span><span class="nd">56</span> <span class="nt">pingbook</span> <span class="nt">systemd</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="o">:</span> <span class="nt">Failed</span> <span class="nt">to</span> <span class="nt">start</span> <span class="nt">Subversion</span> <span class="nt">protocol</span> <span class="nt">daemon</span><span class="o">.</span></span>
<span class="code-line"><span class="nt">7月</span> <span class="nt">08</span> <span class="nt">20</span><span class="p">:</span><span class="nd">06</span><span class="p">:</span><span class="nd">56</span> <span class="nt">pingbook</span> <span class="nt">systemd</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="o">:</span> <span class="nt">svnserve</span><span class="p">.</span><span class="nc">service</span><span class="o">:</span> <span class="nt">Unit</span> <span class="nt">entered</span> <span class="nt">failed</span> <span class="nt">state</span><span class="o">.</span></span>
<span class="code-line"><span class="nt">7月</span> <span class="nt">08</span> <span class="nt">20</span><span class="p">:</span><span class="nd">06</span><span class="p">:</span><span class="nd">56</span> <span class="nt">pingbook</span> <span class="nt">systemd</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="o">:</span> <span class="nt">svnserve</span><span class="p">.</span><span class="nc">service</span><span class="o">:</span> <span class="nt">Failed</span> <span class="nt">with</span> <span class="nt">result</span> <span class="s1">&#39;resources&#39;</span><span class="o">.</span></span>
<span class="code-line"><span class="nt">7月</span> <span class="nt">08</span> <span class="nt">20</span><span class="p">:</span><span class="nd">06</span><span class="p">:</span><span class="nd">56</span> <span class="nt">pingbook</span> <span class="nt">systemd</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="o">:</span> <span class="nt">svnserve</span><span class="p">.</span><span class="nc">service</span><span class="o">:</span> <span class="nt">Service</span> <span class="nt">hold-off</span> <span class="nt">time</span> <span class="nt">over</span><span class="o">,</span> <span class="nt">scheduling</span> <span class="nt">restart</span><span class="o">.</span></span>
<span class="code-line"><span class="nt">7月</span> <span class="nt">08</span> <span class="nt">20</span><span class="p">:</span><span class="nd">06</span><span class="p">:</span><span class="nd">56</span> <span class="nt">pingbook</span> <span class="nt">systemd</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="o">:</span> <span class="nt">Stopped</span> <span class="nt">Subversion</span> <span class="nt">protocol</span> <span class="nt">daemon</span><span class="o">.</span></span>
<span class="code-line"><span class="nt">7月</span> <span class="nt">08</span> <span class="nt">20</span><span class="p">:</span><span class="nd">06</span><span class="p">:</span><span class="nd">56</span> <span class="nt">pingbook</span> <span class="nt">systemd</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="o">:</span> <span class="nt">svnserve</span><span class="p">.</span><span class="nc">service</span><span class="o">:</span> <span class="nt">Start</span> <span class="nt">request</span> <span class="nt">repeated</span> <span class="nt">too</span> <span class="nt">quickly</span><span class="o">.</span></span>
<span class="code-line"><span class="nt">7月</span> <span class="nt">08</span> <span class="nt">20</span><span class="p">:</span><span class="nd">06</span><span class="p">:</span><span class="nd">56</span> <span class="nt">pingbook</span> <span class="nt">systemd</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="o">:</span> <span class="nt">Failed</span> <span class="nt">to</span> <span class="nt">start</span> <span class="nt">Subversion</span> <span class="nt">protocol</span> <span class="nt">daemon</span><span class="o">.</span></span>
<span class="code-line"><span class="nt">7月</span> <span class="nt">08</span> <span class="nt">20</span><span class="p">:</span><span class="nd">06</span><span class="p">:</span><span class="nd">56</span> <span class="nt">pingbook</span> <span class="nt">systemd</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="o">:</span> <span class="nt">svnserve</span><span class="p">.</span><span class="nc">service</span><span class="o">:</span> <span class="nt">Unit</span> <span class="nt">entered</span> <span class="nt">failed</span> <span class="nt">state</span><span class="o">.</span></span>
<span class="code-line"><span class="nt">7月</span> <span class="nt">08</span> <span class="nt">20</span><span class="p">:</span><span class="nd">06</span><span class="p">:</span><span class="nd">56</span> <span class="nt">pingbook</span> <span class="nt">systemd</span><span class="cp">[</span><span class="mi">1</span><span class="cp">]</span><span class="o">:</span> <span class="nt">svnserve</span><span class="p">.</span><span class="nc">service</span><span class="o">:</span> <span class="nt">Failed</span> <span class="nt">with</span> <span class="nt">result</span> <span class="s1">&#39;resources&#39;</span><span class="o">.</span></span>
</pre></div>


<ol>
<li>checkout一份代码到nginx服务器,保持web同步,注意checkout的目录用户要是svn的用户和组,这样hook才能有权限读写</li>
</ol>
<div class="highlight"><pre><span class="code-line"><span></span>$ sudo svn co svn://localhost/svn /www/pingbook.top --username <span class="s2">&quot;hr&quot;</span></span>
<span class="code-line">$ <span class="nb">cd</span> /www/pingbook.top</span>
<span class="code-line">$ sudo chown -R svn:svn *</span>
<span class="code-line">$ sudo chown -R svn:svn /www/pingbook.top</span>
<span class="code-line">$ sudo chmod -R <span class="m">757</span> /www/pingbook.top</span>
<span class="code-line">$ sudo chmod -R <span class="m">757</span> /www/pingbook.top/.svn   <span class="c1"># 配置svn数据仓库 </span></span>
<span class="code-line">$ sudo svn cleanup</span>
</pre></div>


<p>如果commit的时候发现<code>hook</code>的<code>post-commit</code>总是报错: <code>post-commit hook failed (exit code 255) with no output</code>,需要检查对应的文件的读写权限.
1. 检查对应的<code>post-commit</code>的用户组是<code>svn</code>,对应的文件有执行权限: <code>sudo chmod g+e /srv/svn/hook/post-commit</code></p>
                </div><!-- /.entry-content -->
                <ul style="float:right;">
                        <li>
                            ◄&nbsp;&nbsp;<a href="../../articles/pi-mysql/">
                            [Linux环境搭建] <span class="caps">MYSQL</span>&nbsp;的安装配置
                        </a>
                        </li>
                        <li>
                            ►&nbsp;&nbsp;<a href="../../articles/pi-tomcat/">
                            [Linux环境搭建]&nbsp;Debian如何安装配置Tomcat9
                        </a>
                        </li>
                </ul>
                <div class="comments">
                    <h3>相关文章</h3>
                </div>
                    <div class="comments">
                        <h3>留言评论</h3>
                        <div id="disqus_thread"></div>
                        <script type="text/javascript">
                            var disqus_identifier = "articles/pi-svn/";
                            (function () {
                                var dsq = document.createElement('script');
                                dsq.type = 'text/javascript';
                                dsq.async = true;
                                dsq.src = 'https://pingbook.disqus.com/embed.js';
                                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                            })();
                        </script>
                    </div>

            </div><!-- /.eleven.columns -->

<div class="three columns">
    <nav class="widget sidebarbg">
        <h4>快捷导航</h4>
        <ul>
                <li><a href="/categories">分类</a></li>
                <li><a href="/archives">归档</a></li>
                <li><a href="/tags">标签</a></li>
        </ul>
    </nav>
        <div class="sidebarbg">
            <nav class="widget">
                <h4>分类</h4>
                <ul class="blank">
                        <li><a href="../../category/shu-mei-pai/">树莓派</a></li>
                        <li><a href="../../category/bo-ke-da-jian/">博客搭建</a></li>
                </ul>
            </nav>
        </div>


        <nav class="widget sidebarbg">
            <h4>标签</h4>
            <ul class="blank">
                    <li class="tag-4"><a href="../../tag/tomcat9/">Tomcat9</a></li>
                    <li class="tag-4"><a href="../../tag/mysql/">mysql</a></li>
                    <li class="tag-4"><a href="../../tag/mysqlbei-fen/">mysql备份</a></li>
                    <li class="tag-4"><a href="../../tag/nat123/">nat123</a></li>
                    <li class="tag-4"><a href="../../tag/nginx/">nginx</a></li>
                    <li class="tag-2"><a href="../../tag/pelican/">pelican</a></li>
                    <li class="tag-4"><a href="../../tag/python3/">python3</a></li>
                    <li class="tag-4"><a href="../../tag/svn/">svn</a></li>
                    <li class="tag-1"><a href="../../tag/shu-mei-pai/">树莓派</a></li>
                    <li class="tag-4"><a href="../../tag/shu-mei-pai-jing-xiang/">树莓派镜像</a></li>
            </ul>
        </nav>

        <div class="social sidebarbg">

            <nav class="widget">
                <h4>组织</h4>
                <ul class="blank">
                        <li><a target="_blank" href="mailto:alterhu2020@gmail.com?subject=来自PingBook的问题">邮箱</a></li>
                        <li><a target="_blank" href="https://twitter.com/alterhu2020">twitter</a></li>
                        <li><a target="_blank" href="http://github.com/pingbook">github</a></li>
                </ul>
            </nav>
        </div>
        <nav class="widget sidebarbg">
            <h4>关注</h4>
            <ul>
                    <li><a target="_blank" href="http://www.cnblogs.com/alterhu/">博客园</a></li>
                    <li><a target="_blank" href="http://xiaohanyu.me/about/">Xiao Hanyu</a></li>
            </ul>
        </nav>

</div>        </div><!-- /.row -->


    </section>

    </div><!-- /.row -->
</div><!-- /.container -->


<div class="container.nopad bg">


    <footer id="credits" class="row" style="margin-bottom: 0px">
        <div class="seven columns left-center">

            <address id="about" class="vcard body">
                Copyright ©
                <script>document.write(new Date().getFullYear())</script>
                . 版权归PingBook所有.
                <!--<br />-->
                <div>
                    <span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv"></span>次</span>,
                    <span id="busuanzi_container_site_uv">总访客<span id="busuanzi_value_site_uv"></span>人</span>
                </div>
            </address>
        </div>


        <div class="seven columns">
            <div class="row">
                <ul class="socbtns">





                </ul>
            </div>
        </div>
    </footer>

</div>


<script type="text/javascript">
    var disqus_shortname = 'pingbook';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<script src="../../theme/js/libs/jquery-1.9.1.min.js"></script>
<script src="../../theme/js/libs/gumby.min.js"></script>
<script src="../../theme/js/plugins.js"></script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</body>
</html>