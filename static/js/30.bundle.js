webpackJsonp([30],{'./node_modules/extract-text-webpack-plugin/dist/loader.js?{"omit":1,"remove":true}!./node_modules/vue-style-loader/index.js!./node_modules/css-loader/index.js?{"sourceMap":false}!./node_modules/vue-loader/lib/style-compiler/index.js?{"vue":true,"id":"data-v-166dec05","scoped":false,"hasInlineConfig":false}!./node_modules/vux-loader/src/after-less-loader.js!./node_modules/less-loader/index.js?{"minimize":true,"sourceMap":true}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./node_modules/vux/src/components/sticky/index.vue':function(e,t){},'./node_modules/extract-text-webpack-plugin/dist/loader.js?{"omit":1,"remove":true}!./node_modules/vue-style-loader/index.js!./node_modules/css-loader/index.js?{"sourceMap":false}!./node_modules/vue-loader/lib/style-compiler/index.js?{"vue":true,"id":"data-v-5fa4ac47","scoped":true,"hasInlineConfig":false}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/pages/ProjectUploadDesktop.vue':function(e,t){},"./src/pages/ProjectUploadDesktop.vue":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("./node_modules/babel-runtime/core-js/json/stringify.js"),i=s.n(o);var a=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=t.scrollBox||window,o=t.offset||0,i=!0===t.checkStickySupport||!1;if("string"!=typeof s||(s=document.getElementById(s))){var a=e.offsetTop-o;s.removeEventListener("scroll",s.e);var n=function(){return s===window?document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop:s.scrollTop},l=function(){n()>a?(e.style.top=o+"px",e.classList.add("vux-fixed")):e.classList.remove("vux-fixed")};if(i&&(function(){var e=window.navigator.userAgent.match(/(iPad|iPhone|iPod)\s+OS\s([\d_.]+)/);return e&&e[2]&&6<=parseInt(e[2].replace(/_/g,"."),10)}()||function(){for(var e=["","-webkit-","-ms-","-moz-","-o-"],t="",s=0;s<e.length;s++)t+="position:"+e[s]+"sticky";var o=document.createElement("div"),i=document.body;o.style.cssText="display:none"+t,i.appendChild(o);var a=/sticky/i.test(window.getComputedStyle(o).position);return i.removeChild(o),o=null,a}()))e.style.top=o+"px",e.classList.add("vux-sticky");else{if(e.classList.contains("vux-fixed"))n()<(a=function(e){for(var t=e.nextSibling;1!==t.nodeType;)t=t.nextSibling;return next.classList.contains("vux-sticky-fill")?next:e.parentNode}(e).offsetTop-o)&&e.classList.remove("vux-fixed");else a=e.offsetTop-o;s.e=l,s.addEventListener("scroll",l)}}},n={name:"sticky",data:function(){return{initTimes:0}},created:function(){this.$vux&&this.$vux.bus&&this.$vux.bus.$on("vux:after-view-enter",this.bindSticky)},activated:function(){0<this.initTimes&&this.bindSticky(),this.initTimes++},mounted:function(){var e=this;this.$nextTick(function(){e.bindSticky()})},beforeDestroy:function(){this.$vux&&this.$vux.bus&&this.$vux.bus.$off("vux:after-view-enter",this.bindSticky)},methods:{bindSticky:function(){var e=this;this.disabled||this.$nextTick(function(){a(e.$el,{scrollBox:e.scrollBox,offset:e.offset,checkStickySupport:!(void 0!==e.checkStickySupport)||e.checkStickySupport})})}},props:["scrollBox","offset","checkStickySupport","disabled"]},l={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"vux-sticky-box"},[this._t("default")],2)},staticRenderFns:[]};var d=s("./node_modules/vue-loader/lib/component-normalizer.js")(n,l,!1,function(e){s('./node_modules/extract-text-webpack-plugin/dist/loader.js?{"omit":1,"remove":true}!./node_modules/vue-style-loader/index.js!./node_modules/css-loader/index.js?{"sourceMap":false}!./node_modules/vue-loader/lib/style-compiler/index.js?{"vue":true,"id":"data-v-166dec05","scoped":false,"hasInlineConfig":false}!./node_modules/vux-loader/src/after-less-loader.js!./node_modules/less-loader/index.js?{"minimize":true,"sourceMap":true}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./node_modules/vux/src/components/sticky/index.vue')},null,null).exports,r=s("./src/webconfig.js"),c=s("./src/api/index.js"),u={name:"ProjectUploadDesktop",metaInfo:{title:"全景项目进度表上传"},components:{Sticky:d},data:function(){return{disabled:"undefined"!=typeof navigator&&/iphone/i.test(navigator.userAgent)&&/ucbrowser/i.test(navigator.userAgent),active:1,formData:{name:"",uploadUrl:r.a.ApiServerURI+"/v1/upload/file",codetoken:null},disabledNext:!1}},computed:{uploadParams:{get:function(){return{type:5}}}},methods:{back:function(){this.active--,1>this.active&&(this.active=3)},next:function(){2===this.active&&this.creatNewProject(),3===this.active&&(this.active=1),this.disabledNext||this.active++},creatNewProject:function(){var e=this,t=this.$route.params.openid?this.$route.params.openid:"";if(0<this.formData.name.length&&""!==t&&this.formData.codetoken){var s={name:this.formData.name,openid:t,codetoken:this.formData.codetoken};console.log("新建的数据是: "+i()(s)),c.b.post("/project/d",s).then(function(t){1e3===t.data.code?(e.disabledNext=!1,e.$vux.toast.show({text:"新建项目"+e.formData.name+"成功!"})):(e.disabledNext=!0,e.$notify({title:"新建项目",position:"top-left",message:"遇到未知的异常项目创建失败!",type:"error"}))})}else this.disabledNext=!0,this.$notify({title:"新建项目",position:"top-left",message:"请确认项目名称和对应的进度表已经上传成功!",type:"warning"})},handleUploadSuccess:function(e){var t=e.data;this.formData.codetoken=t.codetoken;var s=this.$route.params.openid?this.$route.params.openid:"";0<this.formData.name.length&&""!==s&&this.formData.codetoken&&(this.disabledNext=!1)}},mounted:function(){this.$store.dispatch("UpdateShowTabbar",!1)}},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{height:"100%",width:"100%","padding-left":"0px","padding-right":"0px"}},[s("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":"1",mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[s("el-menu-item",{attrs:{index:"1"}},[e._v("首页")]),e._v(" "),s("el-menu-item",{attrs:{index:"4"}},[s("a",{attrs:{href:"https://www.yitieyilu.com",target:"_blank"}},[e._v("关于我们")])])],1),e._v(" "),s("sticky",{ref:"sticky",attrs:{"scroll-box":"vux_view_box_body",offset:46,"check-sticky-support":!1,disabled:e.disabled}},[s("el-steps",{attrs:{active:e.active}},[s("el-step",{attrs:{title:"下载项目进度模板"}}),e._v(" "),s("el-step",{attrs:{title:"上传项目进度表"}}),e._v(" "),s("el-step",{attrs:{title:"完成"}})],1)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1===e.active,expression:"active ===1 "}],staticClass:"tip"},[s("h3",[e._v("点击下载工程模板文件")]),e._v(" "),e._m(0)]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:2===e.active,expression:"active === 2"}],staticStyle:{"text-align":"center"}},[s("el-form",{staticStyle:{alignment:"center"},attrs:{model:e.formData}},[s("el-form-item",[s("el-input",{attrs:{placeholder:"输入项目名称"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),s("el-form-item",[s("el-upload",{attrs:{drag:"",action:e.formData.uploadUrl,data:e.uploadParams,"on-success":e.handleUploadSuccess,multiple:""}},[s("i",{staticClass:"el-icon-upload"}),e._v(" "),s("div",{staticClass:"el-upload__text"},[e._v("将项目进度文件拖到此处，或"),s("em",[e._v("点击上传")])]),e._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传xls/xlsx文件，且不超过5M")])])],1)],1)],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:3===e.active,expression:"active === 3"}]},[s("div",{staticStyle:{"text-align":"center"}},[s("el-alert",{attrs:{title:"新建项目成功!",type:"success",description:"你可以回到手机端查看刚刚新建的项目",closable:!1,"show-icon":"",center:""}})],1)]),e._v(" "),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary"},on:{click:e.back}},[e._v("上一步")]),e._v(" "),s("el-button",{staticStyle:{"margin-top":"12px"},attrs:{type:"primary",disabled:e.disabledNext},on:{click:e.next}},[e._v("下一步")])],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticStyle:{"margin-left":"20px"}},[t("li",[t("a",{attrs:{href:"./static/pano/工程进度模板.xls"}},[this._v("工程项目进度模板")])])])}]};var m=s("./node_modules/vue-loader/lib/component-normalizer.js")(u,v,!1,function(e){s('./node_modules/extract-text-webpack-plugin/dist/loader.js?{"omit":1,"remove":true}!./node_modules/vue-style-loader/index.js!./node_modules/css-loader/index.js?{"sourceMap":false}!./node_modules/vue-loader/lib/style-compiler/index.js?{"vue":true,"id":"data-v-5fa4ac47","scoped":true,"hasInlineConfig":false}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/pages/ProjectUploadDesktop.vue')},"data-v-5fa4ac47",null);t.default=m.exports}});