webpackJsonp([29],{'./node_modules/extract-text-webpack-plugin/dist/loader.js?{"omit":1,"remove":true}!./node_modules/vue-style-loader/index.js!./node_modules/css-loader/index.js?{"sourceMap":false}!./node_modules/vue-loader/lib/style-compiler/index.js?{"vue":true,"id":"data-v-01a254a2","scoped":false,"hasInlineConfig":false}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./node_modules/vux/src/components/masker/index.vue':function(e,a){},'./node_modules/extract-text-webpack-plugin/dist/loader.js?{"omit":1,"remove":true}!./node_modules/vue-style-loader/index.js!./node_modules/css-loader/index.js?{"sourceMap":false}!./node_modules/vue-loader/lib/style-compiler/index.js?{"vue":true,"id":"data-v-d75bc93a","scoped":true,"hasInlineConfig":false}!./node_modules/vux-loader/src/after-less-loader.js!./node_modules/less-loader/index.js?{"minimize":true,"sourceMap":true}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/pages/ProjectCamera.vue':function(e,a){},"./node_modules/vux/src/components/masker/index.vue":function(e,a,t){"use strict";function o(e){var a=parseInt(e,16);return[a>>16,255&a>>8,255&a]}String,Number,Boolean;var s={name:"masker",props:{color:{type:String,default:"0, 0, 0"},opacity:{type:Number,default:.5},fullscreen:{type:Boolean,default:!1}},computed:{style:function(){return{backgroundColor:"rgba("+(/,/.test(this.color)?this.color:o(this.color.replace("#","")).join(","))+","+this.opacity+")"}}}},r={render:function(){var e=this.$createElement,a=this._self._c||e;return a("div",{staticClass:"vux-masker-box"},[this._t("default"),this._v(" "),a("div",{staticClass:"vux-masker",class:{"vux-masker-fullscreen":this.fullscreen},style:this.style},[this._t("content")],2)],2)},staticRenderFns:[]};var n=t("./node_modules/vue-loader/lib/component-normalizer.js")(s,r,!1,function(e){t('./node_modules/extract-text-webpack-plugin/dist/loader.js?{"omit":1,"remove":true}!./node_modules/vue-style-loader/index.js!./node_modules/css-loader/index.js?{"sourceMap":false}!./node_modules/vue-loader/lib/style-compiler/index.js?{"vue":true,"id":"data-v-01a254a2","scoped":false,"hasInlineConfig":false}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./node_modules/vux/src/components/masker/index.vue')},null,null);a.a=n.exports},"./src/pages/ProjectCamera.vue":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=t("./node_modules/vux/src/components/flexbox/flexbox.vue"),s=t("./node_modules/vux/src/components/flexbox/flexbox-item.vue"),r=t("./node_modules/vux/src/components/group-title/index.vue"),n=t("./node_modules/vux/src/components/load-more/index.vue"),l=t("./node_modules/vux/src/components/masker/index.vue"),i=t("./node_modules/vux/src/components/popup/index.vue"),d=t("./node_modules/vux/src/components/x-header/index.vue"),c=t("./node_modules/vux/src/components/x-textarea/index.vue"),u=t("./src/utils/DateUtils.js"),m=t("./src/api/index.js"),p=t("./src/utils/PlatformUtils.js"),v=t("./src/utils/ElectronUtils.js"),x=(l.a,r.a,i.a,d.a,o.a,s.a,c.a,n.a,{name:"PanoVideo",components:{Masker:l.a,GroupTitle:r.a,Popup:i.a,XHeader:d.a,Flexbox:o.a,FlexboxItem:s.a,XTextarea:c.a,LoadMore:n.a},data:function(){return{camera:{deviceSerial:"",validateCode:""},addCameraTitle:"添加摄像头",addCameraDlg:!1,cameraOptionAlert:"1",cameraOptionsDialog:!1,videoTitle:"施工现场监控列表",projectname:"未知",cameraList:[{cameraid:2,name:"demo测试",date:Object(u.b)("YYYY-MM-DD"),livestatus:1,screenshot:"",hlsurl:"http://hls.open.ys7.com/openlive/77f8c91f98214c62af4f1886a03c022c.m3u8",rtmpurl:"rtmp://rtmp.open.ys7.com/openlive/77f8c91f98214c62af4f1886a03c022c"}],cameraListMsg:"当前项目没有任何在线的摄像头!",needConfigCamera:!1}},methods:{cameraPlayer:function(e){this.$vux.loading.show({text:"正在加载监控视频..."}),this.$router.push({name:"pcameraplayer",params:{projectid:this.$route.params.projectid,projectname:this.$route.params.projectname,cameraname:e.name,cameraid:e.cameraid,hlsrul:e.hlsrul,rtmpurl:e.rtmpurl}})},saveCameraDevice:function(){var e=this,a={projectid:this.$route.params.projectid,camera:this.camera};m.b.post("/camera",a).then(function(a){var t=a.data.code;if(1e3===t||1007===t)e.$vux.toast.show({text:a.data.data.msg}),Object(p.b)()?e.$router.go(0):Object(v.b)();else if(1006===t){var o=a.data.data.code,s=a.data.data.msg;e.$vux.alert.show({title:"添加摄像头出错",maskZIndex:999999,content:"错误代码: "+o+",错误原因: "+s})}else e.$vux.alert.show({title:"服务器端异常",maskZIndex:999999,content:"未捕获的服务器端异常,请稍后重试!"})})},addCameraDialog:function(){this.needConfigCamera?this.$router.push({name:"pupload"}):this.addCameraDlg=!0},fetchCameraList:function(){var e=this,a=this.$route.params.projectid,t=this.$route.params.projectname;t&&a?(this.projectname=t,this.$vux.loading.show({text:"正在读取摄像头列表..."}),m.b.get("/camera/"+a).then(function(a){var t=a.data.code;if(e.$vux.loading.hide(),1e3===t){var o=a.data.data.forEach(function(e){e.date=Object(u.b)("YYYY-MM-DD")});e.cameraList=o}else 1002===t||(1004===t?(e.cameraList=a.data.data,e.needConfigCamera=!0,e.addCameraTitle="配置摄像头",e.cameraListMsg="当前项目没有配置摄像头,请点击按钮先配置该项目摄像头信息后再试!"):e.$vux.alert.show({title:"服务器端异常",content:"获取摄像头列表未捕获的数据异常,请稍后重试!"}))}).catch(function(a){console.log("读取摄像头列表出错: "+a),e.$vux.loading.hide()})):(this.needConfigCamera=!0,this.addCameraTitle="配置摄像头",this.cameraListMsg="当前项目没有配置摄像头,请点击按钮先配置该项目摄像头信息后再试!")}},mounted:function(){this.$store.dispatch("UpdateShowHeader",!1),this.$store.dispatch("UpdateShowTabbar",!1),this.fetchCameraList()}}),f={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("x-header",{attrs:{"left-options":{showBack:!0,preventGoBack:!0},title:e.videoTitle},nativeOn:{click:function(a){e.$router.push({name:"phome"})}}},[t("span",{attrs:{slot:"right"},on:{click:function(a){e.cameraOptionsDialog=!0}},slot:"right"},[e._v("\n        设置\n      ")])]),e._v(" "),t("div",[t("group",[t("cell",{attrs:{title:"当前项目"}},[e._v(e._s(e.projectname))])],1),e._v(" "),t("group-title",{attrs:{slot:"title"},slot:"title"},[e._v("施工现场摄像头列表(共有"+e._s(e.cameraList.length)+"个摄像头)")]),e._v(" "),e._l(e.cameraList,function(a,o){return t("div",{key:o,staticStyle:{margin:"10px",overflow:"hidden"}},[t("masker",{staticStyle:{"border-radius":"2px"},attrs:{opacity:.2},nativeOn:{click:function(t){e.cameraPlayer(a)}}},[t("div",{staticClass:"m-img",style:{backgroundImage:"url("+a.screenshot+")"}}),e._v(" "),t("div",{staticClass:"m-title",attrs:{slot:"content"},slot:"content"},[e._v("\n          "+e._s(a.name)+"("+e._s(1===a.livestatus?"在线":"不在线")+")\n          "),t("br"),e._v(" "),t("span",{staticClass:"m-time"},[e._v(e._s(a.date))])])])],1)}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:0===e.cameraList.length,expression:"cameraList.length===0"}]},[t("br"),e._v(" "),t("br"),e._v(" "),t("load-more",{attrs:{"show-loading":!1,tip:e.cameraListMsg,"background-color":"#fbf9fe"}})],1),e._v(" "),t("flexbox",{staticStyle:{"margin-top":"20%"}},[t("flexbox-item",{attrs:{span:2}}),e._v(" "),t("flexbox-item",{attrs:{span:8}},[t("x-button",{staticStyle:{"border-radius":"99px"},attrs:{type:"primary"},nativeOn:{click:function(a){return e.addCameraDialog(a)}}},[e._v(e._s(e.addCameraTitle)+"\n        ")])],1),e._v(" "),t("flexbox-item",{attrs:{span:2}})],1)],2),e._v(" "),t("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[t("popup",{attrs:{height:"310px","hide-on-blur":!0,"popup-style":{zIndex:2e3}},model:{value:e.addCameraDlg,callback:function(a){e.addCameraDlg=a},expression:"addCameraDlg"}},[t("div",{staticStyle:{width:"95%","background-color":"#fff",height:"310px",margin:"0 auto","border-radius":"5px","padding-top":"10px"}},[t("group",{attrs:{title:"添加摄像头设备"}},[t("x-input",{attrs:{max:9,placeholder:"该摄像头名称,长度不大于25位(可选)"},model:{value:e.camera.name,callback:function(a){e.$set(e.camera,"name","string"==typeof a?a.trim():a)},expression:"camera.name"}}),e._v(" "),t("x-input",{attrs:{max:9,placeholder:"请输入9位摄像头序列号"},model:{value:e.camera.deviceSerial,callback:function(a){e.$set(e.camera,"deviceSerial","string"==typeof a?a.trim():a)},expression:"camera.deviceSerial"}}),e._v(" "),t("x-input",{attrs:{max:6,placeholder:"摄像头验证码，即摄像头机身上的六位大写字母"},model:{value:e.camera.validateCode,callback:function(a){e.$set(e.camera,"validateCode","string"==typeof a?a.trim():a)},expression:"camera.validateCode"}})],1),e._v(" "),t("div",{staticStyle:{padding:"8px 15px"}},[t("x-button",{attrs:{type:"primary",disabled:9!==e.camera.deviceSerial.length||6!==e.camera.validateCode.length},nativeOn:{click:function(a){return e.saveCameraDevice(a)}}},[e._v("确认添加\n          ")]),e._v(" "),t("x-button",{nativeOn:{click:function(a){e.addCameraDlg=!1}}},[e._v("取消")])],1)],1)])],1),e._v(" "),t("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[t("popup",{attrs:{height:"100%"},model:{value:e.cameraOptionsDialog,callback:function(a){e.cameraOptionsDialog=a},expression:"cameraOptionsDialog"}},[t("x-header",{attrs:{title:"摄像头配置","left-options":{showBack:!0,preventGoBack:!0}},on:{"on-click-back":function(a){e.cameraOptionsDialog=!1}}}),e._v(" "),t("group",[t("x-switch",{attrs:{title:"感应报警提醒","value-map":["0","1"]},model:{value:e.cameraOptionAlert,callback:function(a){e.cameraOptionAlert=a},expression:"cameraOptionAlert"}}),e._v(" "),t("x-switch",{attrs:{title:"开启设备自动升级","value-map":["0","1"]},model:{value:e.cameraOptionAlert,callback:function(a){e.cameraOptionAlert=a},expression:"cameraOptionAlert"}})],1)],1)],1)],1)},staticRenderFns:[]};var h=t("./node_modules/vue-loader/lib/component-normalizer.js")(x,f,!1,function(e){t('./node_modules/extract-text-webpack-plugin/dist/loader.js?{"omit":1,"remove":true}!./node_modules/vue-style-loader/index.js!./node_modules/css-loader/index.js?{"sourceMap":false}!./node_modules/vue-loader/lib/style-compiler/index.js?{"vue":true,"id":"data-v-d75bc93a","scoped":true,"hasInlineConfig":false}!./node_modules/vux-loader/src/after-less-loader.js!./node_modules/less-loader/index.js?{"minimize":true,"sourceMap":true}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/pages/ProjectCamera.vue')},"data-v-d75bc93a",null);a.default=h.exports}});