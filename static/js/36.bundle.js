webpackJsonp([36],{'./node_modules/extract-text-webpack-plugin/dist/loader.js?{"omit":1,"remove":true}!./node_modules/vue-style-loader/index.js!./node_modules/css-loader/index.js?{"sourceMap":false}!./node_modules/vue-loader/lib/style-compiler/index.js?{"vue":true,"id":"data-v-b471f1fa","scoped":true,"hasInlineConfig":false}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/pages/PanoAdminUserManage.vue':function(e,t){},"./src/pages/PanoAdminUserManage.vue":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("./node_modules/vux/src/components/badge/index.vue"),a=o("./node_modules/vux/src/components/button-tab/button-tab.vue"),s=o("./node_modules/vux/src/components/button-tab/button-tab-item.vue"),r=o("./node_modules/vux/src/components/divider/index.vue"),c=o("./node_modules/vux/src/components/flexbox/flexbox.vue"),i=o("./node_modules/vux/src/components/flexbox/flexbox-item.vue"),l=o("./node_modules/vux/src/components/form-preview/index.vue"),u=o("./node_modules/vux/src/components/group-title/index.vue"),d=o("./node_modules/vux/src/components/icon/index.vue"),v=o("./node_modules/vux/src/components/load-more/index.vue"),p=o("./node_modules/vux/src/components/popup/index.vue"),m=o("./node_modules/vux/src/components/swipeout/swipeout.vue"),b=o("./node_modules/vux/src/components/swipeout/swipeout-button.vue"),h=o("./node_modules/vux/src/components/swipeout/swipeout-item.vue"),f=o("./node_modules/vux/src/components/x-header/index.vue"),x=o("./src/utils/StoreUtils.js"),_=o("./src/webconfig.js"),w=o("./src/api/index.js"),g=o("./src/components/sticky.js"),k=(r.a,a.a,s.a,p.a,f.a,m.a,h.a,b.a,v.a,n.a,l.a,u.a,c.a,i.a,d.a,g.a,{name:"PanoAdminManage",components:{Divider:r.a,ButtonTab:a.a,ButtonTabItem:s.a,Popup:p.a,XHeader:f.a,Swipeout:m.a,SwipeoutItem:h.a,SwipeoutButton:b.a,LoadMore:v.a,Badge:n.a,FormPreview:l.a,GroupTitle:u.a,Flexbox:c.a,FlexboxItem:i.a,Icon:d.a},directives:{sticky:g.a},data:function(){return{tab:x.a.get(_.a.StoreManageTab)?x.a.get(_.a.StoreManageTab):0,roles:[],accounts:[],accountsNumber:0,currentUserInfo:{},accountTransferDlg:!1,transferAccountData:{userid:null}}},methods:{updateAccount:function(e){this.$router.push({name:"adminuseraccount",params:{fromUpdate:!0,userid:e.userkey,roleid:e.rolekey,parentroleids:e.parentroleids,nickname:e.nickname,username:e.phone}})},lockedAccount:function(e){var t=this,o="/company/user/froze/"+e.userid,n={froze:!e.locked};w.b.put(o,n).then(function(o){1e3===o.data.code&&(t.$vux.toast.show({text:"冻结用户状态成功!"}),e.locked=!e.locked)})},deleteAccount:function(e,t){var o=this,n="/company/user/del/"+e.userid;w.b.delete(n).then(function(e){1e3===e.data.code&&(o.$vux.toast.show({text:"删除用户成功!"}),o.accounts.splice(t,1))})},updateRole:function(e){this.$router.push({name:"adminroleupdate",params:{roles:this.roles,name:e.name,roleid:e.roleid,parentid:e.parentid,parentname:e.parentname,canproject:e.canproject,cantask:e.cantask,canpano:e.canpano,cancheckin:e.cancheckin,canmaterial:e.canmaterial,canlabor:e.canlabor,canmaterialapprove:e.canmaterialapprove}})},deleteRole:function(e,t){var o=this;this.$vux.loading.show({text:"删除职位中..."}),w.b.post("/company/role/update",{roleid:e.roleid}).then(function(e){1e3===e.data.code&&(o.$vux.loading.hide(),o.$vux.toast.show({text:"删除用户成功!"}),o.roles.splice(t,1))}).catch(function(e){o.$vux.loading.hide(),console.log("删除用户失败! "+e)})},clickTab:function(){0===this.tab?(this.fetchAllRoles(),x.a.set(_.a.StoreManageTab,0)):(this.fetchAvailableAccounts(),x.a.set(_.a.StoreManageTab,1))},fetchAllRoles:function(){var e=this,t=this;this.roles=[];var o=this.currentUserInfo.companyid,n=this.currentUserInfo.roleid;this.$vux.loading.show({text:"正在加载数据..."}),w.b.get("/company/roles/"+o+"/"+n).then(function(o){var n=o.data.code;(e.$vux.loading.hide(),1e3===n)&&o.data.data.forEach(function(e){e["showrole"+e.row]=!1,t.roles.push(e)})}).catch(function(t){e.$vux.loading.hide(),console.log("获取职位列表出错: "+t)})},fetchAvailableAccounts:function(){var e=this;this.accounts=[];var t=this.currentUserInfo.companyid;this.$vux.loading.show({text:"正在加载数据..."}),w.b.get("/company/users/"+t).then(function(t){var o=t.data.code;if(e.$vux.loading.hide(),1e3===o){var n=t.data.data;e.accountsNumber=n.count,n.items.forEach(function(t){t.result.forEach(function(e){e["showaccount"+e.row]=!1}),e.accounts.push(t)})}}).catch(function(t){e.$vux.loading.hide(),console.log("获取账号列表出错: "+t)})}},mounted:function(){this.$store.dispatch("UpdateShowTabbar",!1);var e=x.a.get(_.a.StoreUserInfoKey);this.currentUserInfo=e.customerdata,0===this.tab?this.fetchAllRoles():this.fetchAvailableAccounts()}}),y={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("x-header",{attrs:{title:"系统管理","left-options":{showBack:!0,preventGoBack:!1}}},[o("span",{staticStyle:{"font-size":"16px !important","font-weight":"400"},attrs:{slot:"right"},on:{click:function(t){e.$router.push({name:"adminuseraccount"})}},slot:"right"},[e._v("\n    新建账号\n    ")])]),e._v(" "),o("br"),e._v(" "),o("button-tab",{directives:[{name:"sticky",rawName:"v-sticky",value:{zIndex:100,stickyTop:0,className:"sticky-buttons"},expression:"{ zIndex: 100, stickyTop: 0, className: 'sticky-buttons' }"}],model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[o("button-tab-item",{on:{"on-item-click":function(t){e.clickTab()}}},[e._v("职位管理")]),e._v(" "),o("button-tab-item",{on:{"on-item-click":function(t){e.clickTab()}}},[e._v("人员管理")])],1),e._v(" "),0===e.tab?[e.roles.length>0?o("group",[o("swipeout",e._l(e.roles,function(t,n){return o("swipeout-item",{key:n,attrs:{threshold:.5,"underlay-color":"#ccc"}},[o("div",{attrs:{slot:"right-menu"},slot:"right-menu"},[o("swipeout-button",{attrs:{type:"primary"},nativeOn:{click:function(o){e.updateRole(t,n)}}},[e._v("修改")]),e._v(" "),o("swipeout-button",{attrs:{type:"warn"},nativeOn:{click:function(o){e.deleteRole(t,n)}}},[e._v("删除")])],1),e._v(" "),o("div",{staticClass:"project-content vux-1px-tb",attrs:{slot:"content"},slot:"content"},[o("cell",{key:n,attrs:{title:t.name,"inline-desc":"创建时间:"+t.createdate,"is-link":"","border-intent":!1,"arrow-direction":t["showrole"+t.row]?"up":"down"},nativeOn:{click:function(e){t["showrole"+t.row]=!t["showrole"+t.row]}}}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t["showrole"+t.row],expression:"role['showrole'+role.row]"}]},[o("form-preview",{attrs:{"header-label":"职位","header-value":t.name,"body-items":[{label:"可添加和汇总进场材料",value:t.canmaterial?"是":"否"},{label:"可添加和汇总人工动态",value:t.canlabor?"是":"否"},{label:"可审核材料",value:t.canmaterialapprove?"是":"否"}]}})],1)],1)])}))],1):e._e(),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:0===e.roles.length,expression:"roles.length ===0"}]},[o("br"),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("load-more",{attrs:{"show-loading":!1,tip:"当前系统没有任何职位!","background-color":"#fbf9fe"}})],1)]:e._e(),e._v(" "),1===e.tab?[e.accounts.length>0?o("group",[o("group-title",{staticStyle:{"font-size":"13px"}},[e._v("共有"),o("b",[e._v(e._s(e.accountsNumber))]),e._v("个员工")]),e._v(" "),e._l(e.accounts,function(t,n){return o("div",{key:n},[o("group-title",[o("b",[e._v("职位: "+e._s(t.role))])]),e._v(" "),o("swipeout",e._l(t.result,function(t,n){return o("swipeout-item",{key:n,attrs:{threshold:.5,"underlay-color":"#ccc"}},[o("div",{attrs:{slot:"right-menu"},slot:"right-menu"},[o("swipeout-button",{attrs:{type:"primary"},nativeOn:{click:function(o){e.updateAccount(t,n)}}},[e._v("修改")]),e._v(" "),o("swipeout-button",{attrs:{"background-color":"#336DD6"},nativeOn:{click:function(o){e.lockedAccount(t,n)}}},[e._v("\n                "+e._s(t.locked?"解冻":"冻结")+"\n              ")]),e._v(" "),o("swipeout-button",{attrs:{type:"warn"},nativeOn:{click:function(o){e.deleteAccount(t,n)}}},[e._v("删除")])],1),e._v(" "),o("div",{staticClass:"project-content vux-1px-tb",attrs:{slot:"content"},slot:"content"},[o("cell",{key:n,attrs:{title:t.nickname,"inline-desc":"创建时间:"+t.createdate,"is-link":"","border-intent":!1,"arrow-direction":t["showaccount"+t.row]?"up":"down"},nativeOn:{click:function(e){t["showaccount"+t.row]=!t["showaccount"+t.row]}}},[t.locked?o("badge",{staticStyle:{"background-color":"red"},attrs:{slot:"icon",text:"冻结中"},slot:"icon"}):o("badge",{staticStyle:{"background-color":"#0bb20c"},attrs:{slot:"icon",text:"正常"},slot:"icon"})],1),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t["showaccount"+t.row],expression:"account['showaccount'+account.row]"}]},[o("form-preview",{attrs:{"header-label":"职位","header-value":t.rolename,"body-items":[{label:"账号",value:t.phone},{label:"用户状态",value:t.locked?"冻结":"正常"}]}})],1)],1)])}))],1)})],2):e._e(),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:0===e.accounts.length,expression:"accounts.length ===0"}]},[o("br"),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("load-more",{attrs:{"show-loading":!1,tip:"当前组织没有任何账号","background-color":"#fbf9fe"}})],1)]:e._e(),e._v(" "),o("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[o("popup",{attrs:{height:"100%"},model:{value:e.accountTransferDlg,callback:function(t){e.accountTransferDlg=t},expression:"accountTransferDlg"}},[o("x-header",{attrs:{title:"人员离岗权限移交","left-options":{showBack:!0,preventGoBack:!0}},on:{"on-click-back":function(t){e.accountTransferDlg=!1}}})],1)],1)],2)},staticRenderFns:[]};var j=o("./node_modules/vue-loader/lib/component-normalizer.js")(k,y,!1,function(e){o('./node_modules/extract-text-webpack-plugin/dist/loader.js?{"omit":1,"remove":true}!./node_modules/vue-style-loader/index.js!./node_modules/css-loader/index.js?{"sourceMap":false}!./node_modules/vue-loader/lib/style-compiler/index.js?{"vue":true,"id":"data-v-b471f1fa","scoped":true,"hasInlineConfig":false}!./node_modules/vux-loader/src/style-loader.js!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/pages/PanoAdminUserManage.vue')},"data-v-b471f1fa",null);t.default=j.exports}});